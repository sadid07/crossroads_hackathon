{"ast":null,"code":"var _jsxFileName = \"/home/kawsar/incomeexpensesapi-master/src/containers/OrderSummary.js\";\nimport React from \"react\";\nimport { Container, Dimmer, Header, Icon, Image, Label, Loader, Table, Button, Message, Segment } from \"semantic-ui-react\";\nimport { connect } from \"react-redux\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { authAxios } from \"../utils\";\nimport { addToCartURL, orderSummaryURL, orderItemDeleteURL, orderItemUpdateQuantityURL } from \"../constants\";\n\nclass OrderSummary extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: null,\n      error: null,\n      loading: false\n    };\n\n    this.handleFetchOrder = () => {\n      this.setState({\n        loading: true\n      });\n      authAxios.get(orderSummaryURL).then(res => {\n        this.setState({\n          data: res.data,\n          loading: false\n        });\n        console.log(res);\n      }).catch(err => {\n        console.log(err); // if (err.response.status === 404) {\n        //   this.setState({\n        //     error: \"You currently do not have an order\",\n        //     loading: false\n        //   });\n        // } else {\n        //   this.setState({ error: err, loading: false });\n        // }\n      });\n    };\n\n    this.renderVariations = orderItem => {\n      let text = \"\";\n      orderItem.item_variations.forEach(iv => {\n        text += `${iv.variation}: ${iv.value}, `;\n      });\n      return text;\n    };\n\n    this.handleFormatData = itemVariations => {\n      // convert [{id: 1},{id: 2}] to [1,2] - they're all variations\n      return Object.keys(itemVariations).map(key => {\n        return itemVariations[key].id;\n      });\n    };\n\n    this.handleAddToCart = (slug, itemVariations) => {\n      this.setState({\n        loading: true\n      });\n      const variations = this.handleFormatData(itemVariations);\n      authAxios.post(addToCartURL, {\n        slug,\n        variations\n      }).then(res => {\n        this.handleFetchOrder();\n        this.setState({\n          loading: false\n        });\n      }).catch(err => {\n        this.setState({\n          error: err,\n          loading: false\n        });\n      });\n    };\n\n    this.handleRemoveQuantityFromCart = slug => {\n      authAxios.post(orderItemUpdateQuantityURL, {\n        slug\n      }).then(res => {\n        this.handleFetchOrder();\n      }).catch(err => {\n        this.setState({\n          error: err\n        });\n      });\n    };\n\n    this.handleRemoveItem = itemID => {\n      authAxios.delete(orderItemDeleteURL(itemID)).then(res => {\n        this.handleFetchOrder();\n      }).catch(err => {\n        this.setState({\n          error: err\n        });\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.handleFetchOrder();\n  }\n\n  render() {\n    const {\n      data,\n      error,\n      loading\n    } = this.state;\n    const {\n      isAuthenticated\n    } = this.props;\n\n    if (!isAuthenticated) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/login\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 14\n        }\n      });\n    } // console.log(data.order_items);\n\n\n    return /*#__PURE__*/React.createElement(Container, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }\n    }, \"Order Summary\"), error && /*#__PURE__*/React.createElement(Message, {\n      error: true,\n      header: \"There was an error\",\n      content: JSON.stringify(error),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }\n    }), data && /*#__PURE__*/React.createElement(Table, {\n      celled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Table.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Table.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }\n    }, \"Item #\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }\n    }, \"Item name\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }\n    }, \"Item price\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }\n    }, \"Item quantity\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }\n    }, \"Total item price\"))), /*#__PURE__*/React.createElement(Table.Body, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }\n    }, data.order_items.map((orderItem, i) => {\n      return /*#__PURE__*/React.createElement(Table.Row, {\n        key: orderItem.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Table.Cell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }\n      }, i + 1), /*#__PURE__*/React.createElement(Table.Cell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }\n      }, orderItem.item.title, \" -\", \" \", this.renderVariations(orderItem)), /*#__PURE__*/React.createElement(Table.Cell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }\n      }, \"$\", orderItem.item.price), /*#__PURE__*/React.createElement(Table.Cell, {\n        textAlign: \"center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Icon, {\n        name: \"minus\",\n        style: {\n          float: \"left\",\n          cursor: \"pointer\"\n        },\n        onClick: () => this.handleRemoveQuantityFromCart(orderItem.item.slug),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 23\n        }\n      }), orderItem.quantity, /*#__PURE__*/React.createElement(Icon, {\n        name: \"plus\",\n        style: {\n          float: \"right\",\n          cursor: \"pointer\"\n        },\n        onClick: () => this.handleAddToCart(orderItem.item.slug, orderItem.item_variations),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 23\n        }\n      })), /*#__PURE__*/React.createElement(Table.Cell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }\n      }, orderItem.item.discount_price && /*#__PURE__*/React.createElement(Label, {\n        color: \"green\",\n        ribbon: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 25\n        }\n      }, \"ON DISCOUNT\"), \"$\", orderItem.final_price, /*#__PURE__*/React.createElement(Icon, {\n        name: \"trash\",\n        color: \"red\",\n        style: {\n          float: \"right\",\n          cursor: \"pointer\"\n        },\n        onClick: () => this.handleRemoveItem(orderItem.id),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 23\n        }\n      })));\n    }), /*#__PURE__*/React.createElement(Table.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Table.Cell, {\n      textAlign: \"right\",\n      colSpan: \"2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }\n    }, \"Order Total: $\", data.total))), /*#__PURE__*/React.createElement(Table.Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Table.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      colSpan: \"5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      to: \"/checkout\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      floated: \"right\",\n      color: \"yellow\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 21\n      }\n    }, \"Checkout\")))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.auth.token !== null\n  };\n};\n\nexport default connect(mapStateToProps)(OrderSummary);","map":{"version":3,"sources":["/home/kawsar/incomeexpensesapi-master/src/containers/OrderSummary.js"],"names":["React","Container","Dimmer","Header","Icon","Image","Label","Loader","Table","Button","Message","Segment","connect","Link","Redirect","authAxios","addToCartURL","orderSummaryURL","orderItemDeleteURL","orderItemUpdateQuantityURL","OrderSummary","Component","state","data","error","loading","handleFetchOrder","setState","get","then","res","console","log","catch","err","renderVariations","orderItem","text","item_variations","forEach","iv","variation","value","handleFormatData","itemVariations","Object","keys","map","key","id","handleAddToCart","slug","variations","post","handleRemoveQuantityFromCart","handleRemoveItem","itemID","delete","componentDidMount","render","isAuthenticated","props","JSON","stringify","order_items","i","item","title","price","float","cursor","quantity","discount_price","final_price","total","mapStateToProps","auth","token"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  Container,\n  Dimmer,\n  Header,\n  Icon,\n  Image,\n  Label,\n  Loader,\n  Table,\n  Button,\n  Message,\n  Segment\n} from \"semantic-ui-react\";\nimport { connect } from \"react-redux\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport { authAxios } from \"../utils\";\nimport {\n  addToCartURL,\n  orderSummaryURL,\n  orderItemDeleteURL,\n  orderItemUpdateQuantityURL\n} from \"../constants\";\n\nclass OrderSummary extends React.Component {\n  state = {\n    data: null,\n    error: null,\n    loading: false\n  };\n\n  componentDidMount() {\n    this.handleFetchOrder();\n  }\n\n  handleFetchOrder = () => {\n    this.setState({ loading: true });\n    authAxios\n      .get(orderSummaryURL)\n      .then(res => {\n        this.setState({ data: res.data, loading: false });\n        console.log(res);\n      })\n      .catch(err => {\n        console.log(err);\n        // if (err.response.status === 404) {\n        //   this.setState({\n        //     error: \"You currently do not have an order\",\n        //     loading: false\n        //   });\n        // } else {\n        //   this.setState({ error: err, loading: false });\n        // }\n      });\n  };\n\n  renderVariations = orderItem => {\n    let text = \"\";\n    orderItem.item_variations.forEach(iv => {\n      text += `${iv.variation}: ${iv.value}, `;\n    });\n    return text;\n  };\n\n  handleFormatData = itemVariations => {\n    // convert [{id: 1},{id: 2}] to [1,2] - they're all variations\n    return Object.keys(itemVariations).map(key => {\n      return itemVariations[key].id;\n    });\n  };\n\n  handleAddToCart = (slug, itemVariations) => {\n    this.setState({ loading: true });\n    const variations = this.handleFormatData(itemVariations);\n    authAxios\n      .post(addToCartURL, { slug, variations })\n      .then(res => {\n        this.handleFetchOrder();\n        this.setState({ loading: false });\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n      });\n  };\n\n  handleRemoveQuantityFromCart = slug => {\n    authAxios\n      .post(orderItemUpdateQuantityURL, { slug })\n      .then(res => {\n        this.handleFetchOrder();\n      })\n      .catch(err => {\n        this.setState({ error: err });\n      });\n  };\n\n  handleRemoveItem = itemID => {\n    authAxios\n      .delete(orderItemDeleteURL(itemID))\n      .then(res => {\n        this.handleFetchOrder();\n      })\n      .catch(err => {\n        this.setState({ error: err });\n      });\n  };\n\n  render() {\n    const { data, error, loading } = this.state;\n    const { isAuthenticated } = this.props;\n    if (!isAuthenticated) {\n      return <Redirect to=\"/login\" />;\n    }\n    // console.log(data.order_items);\n\n    return (\n      <Container>\n        <Header>Order Summary</Header>\n        {error && (\n          <Message\n            error\n            header=\"There was an error\"\n            content={JSON.stringify(error)}\n          />\n        )}\n\n        {data && (\n          <Table celled>\n            <Table.Header>\n              <Table.Row>\n                <Table.HeaderCell>Item #</Table.HeaderCell>\n                <Table.HeaderCell>Item name</Table.HeaderCell>\n                <Table.HeaderCell>Item price</Table.HeaderCell>\n                <Table.HeaderCell>Item quantity</Table.HeaderCell>\n                <Table.HeaderCell>Total item price</Table.HeaderCell>\n              </Table.Row>\n            </Table.Header>\n\n            <Table.Body>\n              {data.order_items.map((orderItem, i) => {\n                return (\n                  <Table.Row key={orderItem.id}>\n                    <Table.Cell>{i + 1}</Table.Cell>\n                    <Table.Cell>\n                      {orderItem.item.title} -{\" \"}\n                      {this.renderVariations(orderItem)}\n                    </Table.Cell>\n                    <Table.Cell>${orderItem.item.price}</Table.Cell>\n                    <Table.Cell textAlign=\"center\">\n                      <Icon\n                        name=\"minus\"\n                        style={{ float: \"left\", cursor: \"pointer\" }}\n                        onClick={() =>\n                          this.handleRemoveQuantityFromCart(orderItem.item.slug)\n                        }\n                      />\n                      {orderItem.quantity}\n                      <Icon\n                        name=\"plus\"\n                        style={{ float: \"right\", cursor: \"pointer\" }}\n                        onClick={() =>\n                          this.handleAddToCart(\n                            orderItem.item.slug,\n                            orderItem.item_variations\n                          )\n                        }\n                      />\n                    </Table.Cell>\n                    <Table.Cell>\n                      {orderItem.item.discount_price && (\n                        <Label color=\"green\" ribbon>\n                          ON DISCOUNT\n                        </Label>\n                      )}\n                      ${orderItem.final_price}\n                      <Icon\n                        name=\"trash\"\n                        color=\"red\"\n                        style={{ float: \"right\", cursor: \"pointer\" }}\n                        onClick={() => this.handleRemoveItem(orderItem.id)}\n                      />\n                    </Table.Cell>\n                  </Table.Row>\n                );\n              })}\n              <Table.Row>\n                <Table.Cell />\n                <Table.Cell />\n                <Table.Cell />\n                <Table.Cell textAlign=\"right\" colSpan=\"2\">\n                  Order Total: ${data.total}\n                </Table.Cell>\n              </Table.Row>\n            </Table.Body>\n\n            <Table.Footer>\n              <Table.Row>\n                <Table.HeaderCell colSpan=\"5\">\n                  <Link to=\"/checkout\">\n                    <Button floated=\"right\" color=\"yellow\">\n                      Checkout\n                    </Button>\n                  </Link>\n                </Table.HeaderCell>\n              </Table.Row>\n            </Table.Footer>\n          </Table>\n        )}\n      </Container>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.auth.token !== null\n  };\n};\n\nexport default connect(mapStateToProps)(OrderSummary);\n"]},"metadata":{},"sourceType":"module"}